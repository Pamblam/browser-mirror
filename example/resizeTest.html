<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Browser-Mirror Resize Test</title>
		<style>
			body, html{
				margin:0;
				padding:0;
				width:100%;
				height:100%;
			}
			input, textarea, button{
				display:block;
				width:500px;
				border-radius:3px;
				margin:2px;
				padding:2px;
				border:1px solid black;
			}
			#modal{
				margin:0;
				padding:0;
				width:100%;
				height:100%;
				background-color:rgba(255,255,255,0.9);
				position:absolute;
				z-index:9999999999999;
				top:0; 
				left:0;
			}
			#div-inner{
				padding:2em;
			}
			#toast{
				display:none;
				margin:1em;
				padding:1em;
				font-weight: bold;
				background-color:rgba(19, 255, 255, 0.9);
				position:absolute;
				z-index:99999999999999999;
				top:1em; 
				left:1em;
				border:1ps solid black;
				border-radius: 9px;
			}
			#scrollable{
				border: 1px solid black;
				height: 300px;
				overflow: scroll;
			}
		</style>
	</head>
	<body>
		<h1>Browser-Mirror Resize Test</h1>
		<hr>
		
		<div id="formtest"></div>
		
		<form id="myform">
			<input id='forminupt' placeholder="type something here" />
			<button type="submit">submit</button>
		</form>
		
		<hr>
		
		<h2 id="header"></h2>
		<p id="message"></p>
		<hr>
		
		<input id="ti" placeholder="Enter a title">
		<textarea id="ta" placeholder="Enter some details"></textarea>
		<button id="finish">Do some Stuff</button>
		<a href="#" id="clear">Clear</a> | <a href="#" id="rnd">Random Number</a> | <a href="#" id="scr">create scrolling element</a>
		
		<div id="scrollable">
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
			<div>Scroll</div>
		</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div>Scroll</div>
		<div id="toast">this is a toast message</div>
		
		<script>
			var randomState;
			
			var innerDiv = document.getElementById('div-inner');
			var modal = document.getElementById('modal');
			var toast = document.getElementById('toast');
			
			document.getElementById('finish').addEventListener('click', function(){
				document.getElementById('header').innerHTML = document.getElementById('ti').value;
				document.getElementById('message').innerHTML = document.getElementById('ta').value;
			});
			
			document.getElementById('clear').addEventListener('click', function(e){
				e.preventDefault();
				document.getElementById('header').innerHTML = '';
				document.getElementById('message').innerHTML = '';
				document.getElementById('ti').value = '';
				document.getElementById('ta').value = '';
			});
			
			document.getElementById('rnd').addEventListener('click', function(e){
				e.preventDefault();
				randomState = Math.random();
				document.getElementById('ta').value = randomState;
			});
			
			document.getElementById('scr').addEventListener('click', function(e){
				e.preventDefault();
				var div = document.createElement('div');
				div.setAttribute('style', 'width:100%; height:100%; background-color:rgba(255,255,255,0.9); margin:0; padding: 0; overflow: scroll; position:absolute; top:0; left:0;');
				div.innerHTML = '<br>&nbsp;&nbsp;<a href=# id="close"><b>x close</b></a><Br>'+("<div style='padding:1em;'>Sroll...</div>".repeat(50));
				document.body.appendChild(div);
				document.getElementById('close').addEventListener('click', function(e){
					e.preventDefault();
					document.body.removeChild(div);
				});
			});
			
			document.getElementById('myform').onsubmit = function(e){
				e.preventDefault();
				var val = document.getElementById('forminupt').value;
				var formtest = document.getElementById('formtest');
				formtest.innerHTML = val;
			};
			
			function setQSParam(url, key, value=''){
				var qs = url.substr(~url.indexOf("?")?url.indexOf("?")+1:url.length);
				var hash = qs.substr(~url.indexOf('#')?qs.lastIndexOf('#'):qs.length);
				url = url.substr(0, url.length-hash.length);
				qs = qs.substr(0, qs.length-hash.length);
				var sep = !qs&&url.substr(-1)!=='?'?'?':!!qs&&url.substr(-1)!=='&'?'&':'';
				var added=0,nqs=[],k,v,parts; 
				qs.split('&').forEach(kvp=>{
					if(!kvp) return;
					[k,v]=kvp.split('=');
					if(k==key){ 
						v=value;
						added=1;
					}
					nqs.push(k+"="+(v?encodeURIComponent(v):''));
				});
				qs=nqs.join('&');
				if(!added) qs+=(sep+key+"="+(value?encodeURIComponent(value):''));
				var baseurl = url.substr(0,~url.indexOf("?")?url.indexOf("?")+1:url.length);
				return baseurl+qs+hash;
			}
			
			function getParameterByName(name, url){
				name = name.replace(/[\[\]]/g, "\\$&");
				var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
				results = regex.exec(url);
				if (!results) return null;
				if (!results[2]) return '';
				return decodeURIComponent(results[2].replace(/\+/g, " "));
			}
			
			function resizeViewport(w, h){
				if(getParameterByName('bm-viewport', window.location.href)) return;
				var cw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
				var ch = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
				var url = setQSParam(window.location.href, 'bm-viewport', 1);
				var html = `<!doctype hmtl>
				<html>
				<head>
		
				</head>
				<body>
					<iframe src="${url}" width="${w}" height="${h}">
				</body>
				</html>`;
				document.write(html);
			}
			
			setTimeout(()=>resizeViewport(1000, 400), 3000);
		</script>
	</body>
</html>